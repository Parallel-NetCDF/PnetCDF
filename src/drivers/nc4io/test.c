/* Do not edit this file. It is produced from the corresponding .m4 source */
/*
 *  Copyright (C) 2018, Northwestern University and Argonne National Laboratory
 *  See COPYRIGHT notice in top-level directory.
 */
/* $Id$ */



#ifdef HAVE_CONFIG_H
# include <config.h>
#endif

/* Note, netcdf header must come first due to conflicting constant definition */
#include <netcdf.h>

#include <stdio.h>
#include <stdlib.h>

#include <mpi.h>
#include <pnc_debug.h>
#include <common.h>
#include <nc4io_driver.h>

int
nc4io_get_att(void         *ncdp,
              int           varid,
              const char   *name,
              void         *buf,
              MPI_Datatype  itype)
{
    int err;
    NC_nc4 *nc4p = (NC_nc4*)ncdp;
    
    /* Call nc_del_att_<type> */
    if (buftype == MPI_CHAR){
        err = nc_get_att_char(nc4p->ncid, varid, name, (char*) buf);
    }
    else if (buftype == MPI_SIGNED_CHAR){
        err = nc_get_att_schar(nc4p->ncid, varid, name, (char*) buf);
    }
    else if (buftype == MPI_UNSIGNED_CHAR){
        err = nc_get_att_uchar(nc4p->ncid, varid, name, (unsigned char*) buf);
    }
    else if (buftype == MPI_SHORT){
        err = nc_get_att_short(nc4p->ncid, varid, name, (short*) buf);
    }
    else if (buftype == MPI_UNSIGNED_SHORT){
        err = nc_get_att_ushort(nc4p->ncid, varid, name, (unsigned short*) buf);
    }
    else if (buftype == MPI_INT){
        err = nc_get_att_int(nc4p->ncid, varid, name, (int*) buf);
    }
    else if (buftype == MPI_UNSIGNED){
        err = nc_get_att_uint(nc4p->ncid, varid, name, (unsigned int*) buf);
    }
    else if (buftype == MPI_FLOAT){
        err = nc_get_att_float(nc4p->ncid, varid, name, (float*) buf);
    }
    else if (buftype == MPI_DOUBLE){
        err = nc_get_att_double(nc4p->ncid, varid, name, (double*) buf);
    }
    else if (buftype == MPI_LONG_LONG_INT){
        err = nc_get_att_longlong(nc4p->ncid, varid, name, (long long*) buf);
    }
    else if (buftype == MPI_UNSIGNED_LONG_LONG){
        err = nc_get_att_ulonglong(nc4p->ncid, varid, name, (unsigned long long*) buf);
    }
            }
    if (err != NC_NOERR) DEBUG_RETURN_ERROR(err);

    return NC_NOERR;
}

int
nc4io_get_var(void             *ncdp,
              int               varid,
              const MPI_Offset *start,
              const MPI_Offset *count,
              const MPI_Offset *stride,
              const MPI_Offset *imap,
              void             *buf,
              MPI_Offset        bufcount,
              MPI_Datatype      buftype,
              int               reqMode)
{
    int err;
    int apikind;
    NC_nc4 *nc4p = (NC_nc4*)ncdp;
    
    if (start == NULL){
        apikind = NC4_API_KIND_VAR;
    }
    else if (count == NULL){
        apikind = NC4_API_KIND_VAR1;
    }
    else if (stride == NULL){
        apikind = NC4_API_KIND_VARA;
    }
    else if (imap == NULL){
        apikind = NC4_API_KIND_VARS;
    }
    else{
        apikind = NC4_API_KIND_VARM;
    }

    if (apikind == NC4_API_KIND_VAR){
        if (buftype == MPI_CHAR){
            err = nc_get_var_char(nc4p->ncid, varid, (char*) buf);
        }
        else if (buftype == MPI_SIGNED_CHAR){
            err = nc_get_var_schar(nc4p->ncid, varid, (char*) buf);
        }
        else if (buftype == MPI_UNSIGNED_CHAR){
            err = nc_get_var_uchar(nc4p->ncid, varid, (unsigned char*) buf);
        }
        else if (buftype == MPI_SHORT){
            err = nc_get_var_short(nc4p->ncid, varid, (short*) buf);
        }
        else if (buftype == MPI_UNSIGNED_SHORT){
            err = nc_get_var_ushort(nc4p->ncid, varid, (unsigned short*) buf);
        }
        else if (buftype == MPI_INT){
            err = nc_get_var_int(nc4p->ncid, varid, (int*) buf);
        }
        else if (buftype == MPI_UNSIGNED){
            err = nc_get_var_uint(nc4p->ncid, varid, (unsigned int*) buf);
        }
        else if (buftype == MPI_FLOAT){
            err = nc_get_var_float(nc4p->ncid, varid, (float*) buf);
        }
        else if (buftype == MPI_DOUBLE){
            err = nc_get_var_double(nc4p->ncid, varid, (double*) buf);
        }
        else if (buftype == MPI_LONG_LONG_INT){
            err = nc_get_var_longlong(nc4p->ncid, varid, (long long*) buf);
        }
        else if (buftype == MPI_UNSIGNED_LONG_LONG){
            err = nc_get_var_ulonglong(nc4p->ncid, varid, (unsigned long long*) buf);
        }
    }
    else if (apikind == NC4_API_KIND_VAR1){
        if (buftype == MPI_CHAR){
            err = nc_get_var1_char(nc4p->ncid, varid, (stze_t)start, (char*) buf);
        }
        else if (buftype == MPI_SIGNED_CHAR){
            err = nc_get_var1_schar(nc4p->ncid, varid, (stze_t)start, (char*) buf);
        }
        else if (buftype == MPI_UNSIGNED_CHAR){
            err = nc_get_var1_uchar(nc4p->ncid, varid, (stze_t)start, (unsigned char*) buf);
        }
        else if (buftype == MPI_SHORT){
            err = nc_get_var1_short(nc4p->ncid, varid, (stze_t)start, (short*) buf);
        }
        else if (buftype == MPI_UNSIGNED_SHORT){
            err = nc_get_var1_ushort(nc4p->ncid, varid, (stze_t)start, (unsigned short*) buf);
        }
        else if (buftype == MPI_INT){
            err = nc_get_var1_int(nc4p->ncid, varid, (stze_t)start, (int*) buf);
        }
        else if (buftype == MPI_UNSIGNED){
            err = nc_get_var1_uint(nc4p->ncid, varid, (stze_t)start, (unsigned int*) buf);
        }
        else if (buftype == MPI_FLOAT){
            err = nc_get_var1_float(nc4p->ncid, varid, (stze_t)start, (float*) buf);
        }
        else if (buftype == MPI_DOUBLE){
            err = nc_get_var1_double(nc4p->ncid, varid, (stze_t)start, (double*) buf);
        }
        else if (buftype == MPI_LONG_LONG_INT){
            err = nc_get_var1_longlong(nc4p->ncid, varid, (stze_t)start, (long long*) buf);
        }
        else if (buftype == MPI_UNSIGNED_LONG_LONG){
            err = nc_get_var1_ulonglong(nc4p->ncid, varid, (stze_t)start, (unsigned long long*) buf);
        }
    }
    else if (apikind == NC4_API_KIND_VARA){
        if (buftype == MPI_CHAR){
            err = nc_get_vara_char(nc4p->ncid, varid, (stze_t)start, (stze_t)count, (char*) buf);
        }
        else if (buftype == MPI_SIGNED_CHAR){
            err = nc_get_vara_schar(nc4p->ncid, varid, (stze_t)start, (stze_t)count, (char*) buf);
        }
        else if (buftype == MPI_UNSIGNED_CHAR){
            err = nc_get_vara_uchar(nc4p->ncid, varid, (stze_t)start, (stze_t)count, (unsigned char*) buf);
        }
        else if (buftype == MPI_SHORT){
            err = nc_get_vara_short(nc4p->ncid, varid, (stze_t)start, (stze_t)count, (short*) buf);
        }
        else if (buftype == MPI_UNSIGNED_SHORT){
            err = nc_get_vara_ushort(nc4p->ncid, varid, (stze_t)start, (stze_t)count, (unsigned short*) buf);
        }
        else if (buftype == MPI_INT){
            err = nc_get_vara_int(nc4p->ncid, varid, (stze_t)start, (stze_t)count, (int*) buf);
        }
        else if (buftype == MPI_UNSIGNED){
            err = nc_get_vara_uint(nc4p->ncid, varid, (stze_t)start, (stze_t)count, (unsigned int*) buf);
        }
        else if (buftype == MPI_FLOAT){
            err = nc_get_vara_float(nc4p->ncid, varid, (stze_t)start, (stze_t)count, (float*) buf);
        }
        else if (buftype == MPI_DOUBLE){
            err = nc_get_vara_double(nc4p->ncid, varid, (stze_t)start, (stze_t)count, (double*) buf);
        }
        else if (buftype == MPI_LONG_LONG_INT){
            err = nc_get_vara_longlong(nc4p->ncid, varid, (stze_t)start, (stze_t)count, (long long*) buf);
        }
        else if (buftype == MPI_UNSIGNED_LONG_LONG){
            err = nc_get_vara_ulonglong(nc4p->ncid, varid, (stze_t)start, (stze_t)count, (unsigned long long*) buf);
        }
    }
    else if (apikind == NC4_API_KIND_VARS){
        if (buftype == MPI_CHAR){
            err = nc_get_vars_char(nc4p->ncid, varid, (stze_t)start, (stze_t)count, (size_t)stride, (char*) buf);
        }
        else if (buftype == MPI_SIGNED_CHAR){
            err = nc_get_vars_schar(nc4p->ncid, varid, (stze_t)start, (stze_t)count, (size_t)stride, (char*) buf);
        }
        else if (buftype == MPI_UNSIGNED_CHAR){
            err = nc_get_vars_uchar(nc4p->ncid, varid, (stze_t)start, (stze_t)count, (size_t)stride, (unsigned char*) buf);
        }
        else if (buftype == MPI_SHORT){
            err = nc_get_vars_short(nc4p->ncid, varid, (stze_t)start, (stze_t)count, (size_t)stride, (short*) buf);
        }
        else if (buftype == MPI_UNSIGNED_SHORT){
            err = nc_get_vars_ushort(nc4p->ncid, varid, (stze_t)start, (stze_t)count, (size_t)stride, (unsigned short*) buf);
        }
        else if (buftype == MPI_INT){
            err = nc_get_vars_int(nc4p->ncid, varid, (stze_t)start, (stze_t)count, (size_t)stride, (int*) buf);
        }
        else if (buftype == MPI_UNSIGNED){
            err = nc_get_vars_uint(nc4p->ncid, varid, (stze_t)start, (stze_t)count, (size_t)stride, (unsigned int*) buf);
        }
        else if (buftype == MPI_FLOAT){
            err = nc_get_vars_float(nc4p->ncid, varid, (stze_t)start, (stze_t)count, (size_t)stride, (float*) buf);
        }
        else if (buftype == MPI_DOUBLE){
            err = nc_get_vars_double(nc4p->ncid, varid, (stze_t)start, (stze_t)count, (size_t)stride, (double*) buf);
        }
        else if (buftype == MPI_LONG_LONG_INT){
            err = nc_get_vars_longlong(nc4p->ncid, varid, (stze_t)start, (stze_t)count, (size_t)stride, (long long*) buf);
        }
        else if (buftype == MPI_UNSIGNED_LONG_LONG){
            err = nc_get_vars_ulonglong(nc4p->ncid, varid, (stze_t)start, (stze_t)count, (size_t)stride, (unsigned long long*) buf);
        }
    }
    else if (apikind == NC4_API_KIND_VARM){
        if (buftype == MPI_CHAR){
            err = nc_get_varm_char(nc4p->ncid, varid, (stze_t)start, (stze_t)count, (size_t)stride, (size_t)imap, (char*) buf);
        }
        else if (buftype == MPI_SIGNED_CHAR){
            err = nc_get_varm_schar(nc4p->ncid, varid, (stze_t)start, (stze_t)count, (size_t)stride, (size_t)imap, (char*) buf);
        }
        else if (buftype == MPI_UNSIGNED_CHAR){
            err = nc_get_varm_uchar(nc4p->ncid, varid, (stze_t)start, (stze_t)count, (size_t)stride, (size_t)imap, (unsigned char*) buf);
        }
        else if (buftype == MPI_SHORT){
            err = nc_get_varm_short(nc4p->ncid, varid, (stze_t)start, (stze_t)count, (size_t)stride, (size_t)imap, (short*) buf);
        }
        else if (buftype == MPI_UNSIGNED_SHORT){
            err = nc_get_varm_ushort(nc4p->ncid, varid, (stze_t)start, (stze_t)count, (size_t)stride, (size_t)imap, (unsigned short*) buf);
        }
        else if (buftype == MPI_INT){
            err = nc_get_varm_int(nc4p->ncid, varid, (stze_t)start, (stze_t)count, (size_t)stride, (size_t)imap, (int*) buf);
        }
        else if (buftype == MPI_UNSIGNED){
            err = nc_get_varm_uint(nc4p->ncid, varid, (stze_t)start, (stze_t)count, (size_t)stride, (size_t)imap, (unsigned int*) buf);
        }
        else if (buftype == MPI_FLOAT){
            err = nc_get_varm_float(nc4p->ncid, varid, (stze_t)start, (stze_t)count, (size_t)stride, (size_t)imap, (float*) buf);
        }
        else if (buftype == MPI_DOUBLE){
            err = nc_get_varm_double(nc4p->ncid, varid, (stze_t)start, (stze_t)count, (size_t)stride, (size_t)imap, (double*) buf);
        }
        else if (buftype == MPI_LONG_LONG_INT){
            err = nc_get_varm_longlong(nc4p->ncid, varid, (stze_t)start, (stze_t)count, (size_t)stride, (size_t)imap, (long long*) buf);
        }
        else if (buftype == MPI_UNSIGNED_LONG_LONG){
            err = nc_get_varm_ulonglong(nc4p->ncid, varid, (stze_t)start, (stze_t)count, (size_t)stride, (size_t)imap, (unsigned long long*) buf);
        }
    }
     if (err != NC_NOERR) DEBUG_RETURN_ERROR(err);

    return NC_NOERR;
}